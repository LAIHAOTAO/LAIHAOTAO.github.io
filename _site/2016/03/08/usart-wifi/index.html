<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="google-site-verification" content="xBT4GhYoi5qRD5tr338pgPM5OWHHIDR6mNg1a3euekI" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="keyword"  content="">
    <link rel="shortcut icon" href="/img/favicon.ico">

    <title>毕设记录之WiFi完成过程文档 - Eric的博客 | Eric Blog</title>

    <link rel="canonical" href="http://laihaotao.github.io/2016/03/08/usart-wifi/">

    <!-- Bootstrap Core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">

    <!-- Custom CSS -->
    <link rel="stylesheet" href="/css/hux-blog.min.css">

    <!-- Pygments Github CSS -->
    <link rel="stylesheet" href="/css/syntax.css">

    <!-- Custom Fonts -->
    <!-- <link href="http://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css" rel="stylesheet" type="text/css"> -->
    <!-- Hux change font-awesome CDN to qiniu -->
    <link href="http://cdn.staticfile.org/font-awesome/4.2.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">


    <!-- Hux Delete, sad but pending in China
    <link href='http://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/
    css'>
    -->


    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!-- ga & ba script hoook -->
    <script></script>
</head>


<!-- hack iOS CSS :active style -->
<body ontouchstart="">

    <!-- Navigation -->
<nav class="navbar navbar-default navbar-custom navbar-fixed-top">
    <div class="container-fluid">
        <!-- Brand and toggle get grouped for better mobile display -->
        <div class="navbar-header page-scroll">
            <button type="button" class="navbar-toggle">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Eric Blog</a>
        </div>

        <!-- Collect the nav links, forms, and other content for toggling -->
        <!-- Known Issue, found by Hux:
            <nav>'s height woule be hold on by its content.
            so, when navbar scale out, the <nav> will cover tags.
            also mask any touch event of tags, unfortunately.
        -->
        <div id="huxblog_navbar">
            <div class="navbar-collapse">
                <ul class="nav navbar-nav navbar-right">
                    <li>
                        <a href="/">Home</a>
                    </li>
                    
                    <li>
                        <a href="/about/">About</a>
                    </li>
                    
                    <li>
                        <a href="/contact/">Contact</a>
                    </li>
                    
                    <li>
                        <a href="/tags/">Tags</a>
                    </li>
                    
                </ul>
            </div>
        </div>
        <!-- /.navbar-collapse -->
    </div>
    <!-- /.container -->
</nav>
<script>
    // Drop Bootstarp low-performance Navbar
    // Use customize navbar with high-quality material design animation
    // in high-perf jank-free CSS3 implementation
    var $body   = document.body;
    var $toggle = document.querySelector('.navbar-toggle');
    var $navbar = document.querySelector('#huxblog_navbar');
    var $collapse = document.querySelector('.navbar-collapse');

    $toggle.addEventListener('click', handleMagic)
    function handleMagic(e){
        if ($navbar.className.indexOf('in') > 0) {
        // CLOSE
            $navbar.className = " ";
            // wait until animation end.
            setTimeout(function(){
                // prevent frequently toggle
                if($navbar.className.indexOf('in') < 0) {
                    $collapse.style.height = "0px"
                }
            },400)
        }else{
        // OPEN
            $collapse.style.height = "auto"
            $navbar.className += " in";
        }
    }
</script>


    <!-- Image to hack wechat -->
<!-- <img src="/img/icon_wechat.png" width="0" height="0"> -->
<!-- <img src="/img/home-bg.jpg" width="0" height="0"> -->

<!-- Post Header -->
<style type="text/css">
    header.intro-header{
        background-image: url('/img/home-bg.jpg')
    }
</style>
<header class="intro-header" >
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <div class="post-heading">
                    <div class="tags">
                        
                        <a class="tag" href="/tags/#毕业设计" title="毕业设计">毕业设计</a>
                        
                    </div>
                    <h1>毕设记录之WiFi完成过程文档</h1>
                    
                    
                    <h2 class="subheading">Introduction of USART-WiFi Module</h2>
                    
                    <span class="meta">Posted by Eric Blog on March 8, 2016</span>
                </div>
            </div>
        </div>
    </div>
</header>

<!-- Post Content -->
<article>
    <div class="container">
        <div class="row">

    <!-- Post Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                post-container">

				<p><strong>本文是作者原创文章，欢迎转载，请注明出处 from:@<a href="http://laihaotao.github.io">Eric_Lai</a></strong></p>

<p>文档创建时间：2016年3月10日
本文档描述的是如何在<code class="highlighter-rouge">stm32f10x</code>上用串口转wifi模块<code class="highlighter-rouge">ESP8266</code>实现与上位机的通信。
# 模块介绍
ESP8266模块，是一款USART转WiFi模块，可以使嵌入式系统串口通过无线网络与上位机进行通信。</p>

<h2 id="section">引脚</h2>
<p>这个模块的引脚一般引出来的有6个:</p>

<ul>
  <li>VCC：电源（建议接3.3v，在5v下也可以工作，据测试发热量稍大）</li>
  <li>GND：电源地</li>
  <li>TXD：模块串口发送引脚（TTL电平，可接单片机的RXD）</li>
  <li>RXD：模块串口接收引脚（TTL电平，可接单片机的TXD）</li>
  <li>RST：复位（低电平有效）</li>
  <li>IO-0：低电平是进入固件烧写模式，高电平为运行状态（默认状态）</li>
</ul>

<h2 id="section-1">工作模式</h2>
<p>这个模块通常会有三种工作模式：</p>

<ul>
  <li>AP模式，这种模式下模块相当于一个WiFi热点，其他设备可以接入这个热点，从而实现无线通信。（和蓝牙类似，不需要网络也可以实现）</li>
  <li>STA模式，这个模式下模块相当于一个WiFi设备，需要通过路由器与其他的网络设备通信。</li>
  <li>AP+SAT模式，这种模式是上述两种模式的并集。</li>
</ul>

<p>每种模式下，都有若干种“身份”。本文档，主要讨论的是模块在STA模式下充当TCP Client的使用方法。</p>

<h2 id="section-2">指令介绍</h2>
<p>模块提供了一套完整的AT指令，供我们来操作，详细的指令请参考文档，这里不逐一列出。</p>

<blockquote>
  <p><a href="https://laihaotao.github.io/documents/ESP8266%20User_Manual.pdf">ESP8266用户手册 </a></p>
</blockquote>

<h2 id="section-3">注意事项</h2>
<ol>
  <li>波特率115200</li>
  <li>输入以回车换行符‘\r\n’结尾</li>
  <li>使用双引号表示字符串数据</li>
</ol>

<h1 id="section-4">具体实现</h1>
<p>实现WiFi的功能，分成硬件和软件部分。硬件上，使用stm32的USART2与ESP8266相连接。软件上，根据手册，封装AT命令，使用中断读取接收数据等。</p>

<p>引脚连接方式：</p>

<ul>
  <li>ESP8266_RXD连接stm32_USART2_TXD</li>
  <li>ESP8266_TXD连接stm32_USART2_RXD</li>
  <li>ESP8266_VCC连接3.3v</li>
  <li>ESP8266_GND连接GND</li>
  <li>ESP8266_RST悬空</li>
  <li>ESP8266_I0_0悬空</li>
</ul>

<p>PS：stm32与ESP8266要共地。</p>

<p>软件上，主要由下面几个文件来实现WiFi模块的驱动：</p>

<ul>
  <li>wifi_config.c 这个文件主要完成USART2的初始化，USART2的中断控制器配置</li>
  <li>wifi_function.c 这个文件主要实现对wifi模块的AT指令操作，并完成STA TCP Client连接</li>
</ul>

<p>这里不给出详细的代码，具体的代码可以看<a href="https://github.com/LAIHAOTAO/weeding_robot/tree/master/User/wifi">这里</a>，这里重点讨论<code class="highlighter-rouge">wifi_function.c</code>这个文件，下面列出它的函数作解释，具体实现自己看看源文件：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>//使能wifi模块
void ESP8266_Choose ( FunctionalState enumChoose );
//重启模块
void ESP8266_Rst( void );
//执行AT测试
void ESP8266_AT_Test( void );
//发送AT指令
//cmd：AT指令内容， reply1：期望的回应， reply2：期望的回应，waittime：等待时间
bool ESP8266_Cmd( char * cmd, char * reply1, char * reply2, u32 waittime );
//选择wifi模块的模式 AP， STA， AP+STA
bool ESP8266_Net_Mode_Choose( ENUM_Net_ModeTypeDef enumMode );
//开启多客户端连接
bool ESP8266_Enable_MultipleId( FunctionalState enumEnUnvarnishTx );
//连接到服务器（STA模式下需要使用到）
bool ESP8266_Link_Server( ENUM_NetPro_TypeDef enumE, char * ip, char * ComNum, ENUM_ID_NO_TypeDef id);
//开启透传模式
bool ESP8266_UnvarnishSend( void );
//发送数据
bool ESP8266_SendString( FunctionalState enumEnUnvarnishTx, char * pStr, u32 ulStrLength, ENUM_ID_NO_TypeDef ucId );
//接收数据
char *ESP8266_ReceiveString( FunctionalState enumEnUnvarnishTx );
//配置STA_TCP_Client连接模式
bool  ESP8266_STA_TCP_Client( void );
//从透传模式返回普通AT模式
bool ESP8266_Return_At( void );
//失能透传模式
bool ESP8266_Disable_UnvarnishSend( void );
//关闭TCP连接
bool ESP8266_Tcp_Close( void );
//按照配置，开启TCP连接
bool ESP8266_Connect_Tcp( void );
</code></pre>
</div>
<p>具体，是怎么往模块里面发送AT指令的，这里以其中一个为例子进行讲述：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>//加入某个wifi热点的函数
//对应的AT指令是：AT+CWJAP=“ssid”,“passwor”
bool ESP8266_JoinAP ( char * pSSID, char * pPassWord ){
    //声明一个存放命令的区域
	char cCmd [120];
   //通过sprintf函数，将参数传进来的ssid和password拼接到字符串后面，放入之前声明的区域
	sprintf ( cCmd, "AT+CWJAP=\"%s\",\"%s\"", pSSID, pPassWord );
   //通过ESP8266_Cmd ()函数，往模块里面写入命令
	return ESP8266_Cmd ( cCmd, "OK", NULL, 7000 );
}
</code></pre>
</div>
<p>下面，分析下如何配置TCP连接，并使能它的：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>//配置TCP连接
//LCD是为了便于调试添加的，在液晶屏上显示程序的运行信息
bool ESP8266_STA_TCP_Client ( void ){
	bool statusCur = false;
	bool statusLst = true;
	// 开启sta连接模式
	LCD_DispStr(0,0,(uint8_t *)"begin to sta connection ...",BLUE);
	ESP8266_AT_Test ();
	statusCur = ESP8266_Net_Mode_Choose ( STA );
	if (statusCur == true){
		LCD_DispStr(0,20,(uint8_t *)"sta mode success",0xffff);
		statusLst = true;
	}else{
		LCD_DispStr(0,20,(uint8_t *)"sta mode fail",0xffff);
		statusLst = false;
	}
	//加入热点的SSID和PASSWORD
	LCD_DispStr(0,40,(uint8_t *)"begin to join ERIC_LAI ...",BLUE);
    //这里写死了热点的ssid和pw，需要根据各自的情况自行修改
	statusCur = ESP8266_JoinAP ( "ERIC_LAI", "lai686868" );
	if (statusCur == true &amp;&amp; statusLst == true){
		LCD_DispStr(0,60,(uint8_t *)"join ERIC_LAI success",0xffff);
		statusLst = true;
	} else{
		LCD_DispStr(0,60,(uint8_t *)"join ERIC_LAI success",0xffff);
		statusLst = false;
	}
}
</code></pre>
</div>
<div class="highlighter-rouge"><pre class="highlight"><code>//使能TCP连接
bool ESP8266_Connect_Tcp(void){
	bool status = false;
	// 连接到TCP服务器
	ESP8266_Enable_MultipleId ( ENABLE );
	LCD_DispStr(0,120,(uint8_t *)"begin to connect the server ...",BLUE);
	status = ESP8266_Link_Server ( enumTCP, serverIpAddress, "9998", Multiple_ID_0 );
	if (status == true){
		LCD_DispStr(0,140,(uint8_t *)"connect server success",0xffff);
	} else{
		LCD_DispStr(0,140,(uint8_t *)"connect server fail",0xffff);
	}
	return status;
}
</code></pre>
</div>
<p>这一步成功之后，就是接受和发送数据的事情了。因为是串口，所以本质上用的还是串口中断来接收数据的。在wifi_config.c里面，我们完成了串口的使用和中断的配置。但是，串口只能一位一位的发送数据，所以，我们需要写一些代码来实现字符串的接收。上面的注意事项，’\r\n‘是发送完成的标志。所以，我们一直接收数据，知道接收到回车换行符为止。接收到后，标志位置位，退出接收循环。详细代码如下：</p>

<div class="highlighter-rouge"><pre class="highlight"><code>//以下的代码在stm32f10x_it.c里面
void USART2_IRQHandler( void ){
	char ch;
	if(USART_GetITStatus(USART2, USART_IT_RXNE) != RESET){
		ch  = USART_ReceiveData( USART2 );
		if( strEsp8266_Fram_Record .InfBit .FramLength &lt; ( RX_BUF_MAX_LEN - 1 ) ){ //预留1个字节写结束符
        strEsp8266_Fram_Record .Data_RX_BUF [ strEsp8266_Fram_Record .InfBit .FramLength ++ ]  = ch;
		}
	}
	if ( USART_GetITStatus( USART2, USART_IT_IDLE ) == SET ) {//数据帧接收完毕
        strEsp8266_Fram_Record .InfBit .FramFinishFlag = 1;
		ch = USART_ReceiveData( USART2 ); //由软件序列清除中断标志位(先读USART_SR，然后读USART_DR)
  }
}
</code></pre>
</div>

<p>以上，完成之后，通过上面给出的<code class="highlighter-rouge">ESP8266_ReceiveString()</code>函数就可以获取接收到的字符串，注意：这是一个堵塞的函数！一旦调用就会等待接收到回车换行符为止。</p>

<p>上面的代码，在发送数据和接收数据的情况，都没有使用透传模式。所以，发送数据的时候需要确定数据的长度（最长不超过1024），接收数据的时候会有报头（+IDP,*,*:）。所以，发送图片的时候需要将图片分割开来发送，接收的时候需要做数据截断，把报头去掉。关于图片分割，在图片传输的时候讲述，截断数据的方法在下面给出：
<code class="highlighter-rouge">
char* getRealRecv(char *pStr){
	char *pBuf, *ppStr, *pStrDelimiter[2];
	int uc = 0;
	char cStrInput [100];
	sprintf(cStrInput, "%s", pStr);
    pBuf = cStrInput;
		uc = 0;
		while ( ( ppStr = strtok ( pBuf, ":" ) ) != NULL ){
			pStrDelimiter [ uc ++ ] = ppStr;
			pBuf = NULL;
		}
	return pStrDelimiter[1];
}
</code></p>

<p>以上，是WiFi模块的完成过程。</p>


                <hr>

                
                <!-- 多说 Share start -->
                </style>
                <div class="ds-share"
                    style="text-align: right"
                    data-thread-key="/2016/03/08/usart-wifi"
                    data-title="毕设记录之WiFi完成过程文档"
                    data-url="http://laihaotao.github.io/2016/03/08/usart-wifi/"
                    data-images="http://laihaotao.github.io/img/home-bg.jpg"
                    data-content="本文是作者原创文章，欢迎转载，请注明出处 from:@Eric_Lai

文档创建时间：2016年3月10日
本文档描述的是如何在stm32f10x上用串... | Eric的博客 | Eric Blog " >
                    <div class="ds-share-inline">
                      <ul  class="ds-share-icons-16">
                        <li data-toggle="ds-share-icons-more"><a class="ds-more" href="#">分享到：</a></li>
                        <li><a class="ds-wechat flat" href="javascript:void(0);" data-service="wechat">微信</a></li>
                        <li><a class="ds-weibo flat" href="javascript:void(0);" data-service="weibo">微博</a></li>
                        <li><a class="ds-douban flat" href="javascript:void(0);" data-service="douban">豆瓣</a></li>
                      </ul>
                      <div class="ds-share-icons-more">
                      </div>
                    </div>
                <hr>
                </div>
                <!-- 多说 Share end-->
                


                <ul class="pager">
                    
                    <li class="previous">
                        <a href="/2016/02/24/uk-apply/" data-toggle="tooltip" data-placement="top" title="我的英国授课硕士申请经历">&larr; Previous Post</a>
                    </li>
                    
                    
                    <li class="next">
                        <a href="/2016/03/10/python-socket/" data-toggle="tooltip" data-placement="top" title="毕设记录之python利用socket进行文件传输">Next Post &rarr;</a>
                    </li>
                    
                </ul>


                
                <!-- 多说评论框 start -->
                <div class="comment">
                    <div class="ds-thread"
                        data-thread-key="/2016/03/08/usart-wifi"
                        data-title="毕设记录之WiFi完成过程文档"
                        data-url="http://laihaotao.github.io/2016/03/08/usart-wifi/" >
                    </div>
                </div>
                <!-- 多说评论框 end -->
                

                

            </div>

    <!-- Sidebar Container -->
            <div class="
                col-lg-8 col-lg-offset-2
                col-md-10 col-md-offset-1
                sidebar-container">

                <!-- Featured Tags -->
                
                <section>
                    <hr class="hidden-sm hidden-xs">
                    <h5><a href="/tags/">FEATURED TAGS</a></h5>
                    <div class="tags">
        				
                            
                				<a href="/tags/#java" title="java" rel="4">
                                    java
                                </a>
                            
        				
                            
        				
                            
        				
                            
                				<a href="/tags/#数据库" title="数据库" rel="2">
                                    数据库
                                </a>
                            
        				
                            
                				<a href="/tags/#java_ee" title="java_ee" rel="3">
                                    java_ee
                                </a>
                            
        				
                            
                				<a href="/tags/#Android" title="Android" rel="6">
                                    Android
                                </a>
                            
        				
                            
        				
                            
                				<a href="/tags/#project" title="project" rel="2">
                                    project
                                </a>
                            
        				
                            
                				<a href="/tags/#algorithm" title="algorithm" rel="6">
                                    algorithm
                                </a>
                            
        				
                            
                				<a href="/tags/#留学" title="留学" rel="2">
                                    留学
                                </a>
                            
        				
                            
                				<a href="/tags/#毕业设计" title="毕业设计" rel="5">
                                    毕业设计
                                </a>
                            
        				
        			</div>
                </section>
                

                <!-- Friends Blog -->
                
                <hr>
                <h5>FRIENDS</h5>
                <ul class="list-inline">
                    
                        <li><a href="http://victorzhong.github.io">Victor Zhong</a></li>
                    
                        <li><a href="http://effyli.github.io">Effy Li</a></li>
                    
                </ul>
                
            </div>
        </div>
    </div>
</article>


<!-- 多说公共JS代码 start (一个网页只需插入一次) -->
<script type="text/javascript">
    // dynamic User by Hux
    var _user = 'laihaotao';

    // duoshuo comment query.
    var duoshuoQuery = {short_name: _user };
    (function() {
        var ds = document.createElement('script');
        ds.type = 'text/javascript';ds.async = true;
        ds.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') + '//static.duoshuo.com/embed.js';
        ds.charset = 'UTF-8';
        (document.getElementsByTagName('head')[0]
         || document.getElementsByTagName('body')[0]).appendChild(ds);
    })();
</script>
<!-- 多说公共JS代码 end -->







<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>
<!-- anchor-js, Doc:http://bryanbraun.github.io/anchorjs/ -->
<script>
    async("http://cdn.bootcss.com/anchor-js/1.1.1/anchor.min.js",function(){
        anchors.options = {
          visible: 'never',
          placement: 'right',
          icon: '#'
        };
        anchors.add().remove('.intro-header h1').remove('.subheading').remove('.sidebar-container h5');
    })
</script>
<style>
    /* place left on bigger screen */
    @media all and (min-width: 800px) {
        .anchorjs-link{
            position: absolute;
            left: -0.75em;
            font-size: 1.1em;
            margin-top : -0.1em;
        }
    }
</style>



    <!-- Footer -->
<footer>
    <div class="container">
        <div class="row">
            <div class="col-lg-8 col-lg-offset-2 col-md-10 col-md-offset-1">
                <ul class="list-inline text-center">
                    
                    

                    <!-- add Weibo, Zhihu by Hux, add target = "_blank" to <a> by Hux -->
                    
                    <li>
                        <a target="_blank" href="https://www.zhihu.com/people/laihaotao">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa  fa-stack-1x fa-inverse">知</i>
                            </span>
                        </a>
                    </li>
                    
                    
                    <li>
                        <a target="_blank" href="http://weibo.com/eric0325">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-weibo fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    


                    
                    
                    <li>
                        <a target="_blank" href="https://github.com/LAIHAOTAO">
                            <span class="fa-stack fa-lg">
                                <i class="fa fa-circle fa-stack-2x"></i>
                                <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                            </span>
                        </a>
                    </li>
                    
                </ul>
                <p class="copyright text-muted">
                    Copyright &copy; Eric Blog 2016 | 
                    Theme by <a href="http://huangxuan.me">Hux</a>
                </p>
            </div>
        </div>
    </div>
</footer>

<!-- jQuery -->
<script src="/js/jquery.min.js "></script>

<!-- Bootstrap Core JavaScript -->
<script src="/js/bootstrap.min.js "></script>

<!-- Custom Theme JavaScript -->
<script src="/js/hux-blog.min.js "></script>


<!-- async load function -->
<script>
    function async(u, c) {
      var d = document, t = 'script',
          o = d.createElement(t),
          s = d.getElementsByTagName(t)[0];
      o.src = u;
      if (c) { o.addEventListener('load', function (e) { c(null, e); }, false); }
      s.parentNode.insertBefore(o, s);
    }
</script>

<!-- 
     Because of the native support for backtick-style fenced code blocks 
     right within the Markdown is landed in Github Pages, 
     From V1.6, There is no need for Highlight.js, 
     so Huxblog drops it officially.

     - https://github.com/blog/2100-github-pages-now-faster-and-simpler-with-jekyll-3-0  
     - https://help.github.com/articles/creating-and-highlighting-code-blocks/    
-->
<!--
    <script>
        async("http://cdn.bootcss.com/highlight.js/8.6/highlight.min.js", function(){
            hljs.initHighlightingOnLoad();
        })
    </script>
    <link href="http://cdn.bootcss.com/highlight.js/8.6/styles/github.min.css" rel="stylesheet">
-->


<!-- jquery.tagcloud.js -->
<script>
    // only load tagcloud.js in tag.html
    if($('#tag_cloud').length !== 0){
        async("/js/jquery.tagcloud.js",function(){
            $.fn.tagcloud.defaults = {
                //size: {start: 1, end: 1, unit: 'em'},
                color: {start: '#bbbbee', end: '#0085a1'},
            };
            $('#tag_cloud a').tagcloud();
        })
    }
</script>

<!--fastClick.js -->
<script>
    async("http://cdn.bootcss.com/fastclick/1.0.6/fastclick.min.js", function(){
        var $nav = document.querySelector("nav");
        if($nav) FastClick.attach($nav);
    })
</script>


<!-- Google Analytics -->



<!-- Baidu Tongji -->




<!-- Image to hack wechat -->
<img src="/img/icon_wechat.png" width="0" height="0" />
<!-- Migrate from head to bottom, no longer block render and still work -->

</body>

</html>
