<!DOCTYPE html>
<html>
<head>
    <!--
    **
    * 此文档的原作者是PIZn，邮箱pizner@gmail.com
    *
    * 在他的基础上由我做了二次做了修改
    * 本人Eric_Lai,邮箱qq584863350@gmail.com
    * 
    **
    -->
    <meta charset="utf-8" />
    <title>netbean下部署tomcat服务器连接mysql数据库 | Eric_Lai's blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="generator" content="Jekyll" />
    <meta name="author" content="Eric" />
    <meta name="description" content="" />
    <link rel="stylesheet" href="http://laihaotao.github.io/css/style.css" type="text/css" />
    <link rel="stylesheet" href="/css/pygments.css" type="text/css">
    <link rel="alternate" type="application/atom+xml" title="Recent Entries" href="/atom.xml" />
    <link rel="shortcut icon" href="http://laihaotao.github.io/favicon.ico" type="image/x-icon" />
    <!--[if lt IE 9]>
    <script src="http://laihaotao.github.io/js/html5.js" type="text/javascript"></script>
    <![endif]-->
</head>
<body id="default">
<div id="head-line"></div>
<div id="content">
    <header id="head">
        <div id="logo">
            <h1>Eric</h1>
            <h2>Be better than yesterday</h2>
        </div>
        <nav id="nav">
            <ul>
                <li class="fn-clear"><a href="http://laihaotao.github.io" rel="nofollow" class="action"><i class="icon-home"></i> Home</a></li>
                <li class="fn-clear"><a href="http://laihaotao.github.io/archives.html"><i class="icon-list-ul"></i> Archives</a></li>
                <li class="fn-clear"><a href="http://laihaotao.github.io/about.html"><i class="icon-info-sign"></i> About</a></li>
                <li class="fn-clear"><a href="http://laihaotao.github.io/contact.html"><i class="icon-envelope-alt"></i> Contact</a></li>
                <li><img src="http://laihaotao.github.io/images/aboutme.jpg"></li>
                
            </ul>
        </nav>
    </header>
    <section id="contain">
        <header id="begin">
            <span>2015-07-18 00:00:00 +0800</span>
        </header>
		<article class="post">
    <h1 class="post-title">netbean下部署tomcat服务器连接mysql数据库</h1>
    <h1 id="前言">前言</h1>

<p>继续上文，由于学校的项目没人。只好自己来现学现卖，今天研究了一番怎么配置数据库到服务器上。也是废了好一番功夫，我显示参考了NetBeans的官方教程，然而它使用的不是我们常用的Tomcat服务器，而且教程不讲原理只讲步骤我看得好痛苦。一番摸索下来，通过stackflow和tomcat自带的说明文档，用于研究出来了怎么部署。记录一番，以备查用。</p>

<h1 id="环境准备">环境准备</h1>

<p>在准备布置这些之前需要的工具如下并且配置好所需的环境：
NetBeans IDE、tomcat8.0、mysql数据库、一张数据表（本文默认你已经知道怎么把数据库连接到IDE里面，如果不知道的请看这里）
<mark>友情提示1</mark>：tomcat8.0在NetBeans上无法部署的问题，如果报错是 &#39;127.0.0.1&#39; is not recognized as an internal or external command  的话，你需要在tomcat安装目录下找到bin文件夹下的catalina.bat文件，然后用记事本打开它的第179到184行，将以下内容</p>
<div class="highlight"><pre><code class="language-text" data-lang="text">:noJuliConfig
set &quot;JAVA_OPTS=%JAVA_OPTS% %LOGGING_CONFIG%&quot;
..
:noJuliManager
set &quot;JAVA_OPTS=%JAVA_OPTS% %LOGGING_MANAGER%&quot;
更改为：

:noJuliConfig
set JAVA_OPTS=%JAVA_OPTS% %LOGGING_CONFIG%
..
:noJuliManager
set JAVA_OPTS=%JAVA_OPTS% %LOGGING_MANAGER%
</code></pre></div>
<p><strong>简单的说就是把这两出的双引号去掉。然后保存，重新打开tomcat即可完成部署。</strong>
<mark>友情提示2</mark>：在进入NetBeans开始配置之前还有很重要的事情，要把从mysql上下载的JDBC驱动放到tomcat的安装目录的cof目录下，通过它的官方文档可以知道，只有这样只有在这个文件夹里的文件对tomcat启动的时候才是可见的。而且每次启动tomcat只会读取一次，所以必须要在没有启动服务器之前放到这个文件夹里面。注意这个JDBC的jre版本有讲究，太新的驱动不能配太老的数据库。这里我给出一个我可以用的。</p>

<h1 id="在ide下配置数据库连接池">在IDE下配置数据库连接池</h1>

<p>在这之前我们需要下载两个Apache要求的jre文件（分别是jstl和stander），并把他们添加到工程的WEB-INF下的lib文件夹里（没有就新建）。没有的话下载的连接在这里。
首先，我们需要配置JNDI到tomcat。找到Context.xml这个文件，双击之打开源码。加入以下内容：</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml"><span class="nt">&lt;Resource</span> <span class="na">name=</span><span class="s">&quot;jdbc/DbTest(你的工程名字)&quot;</span> 
                <span class="na">auth=</span><span class="s">&quot;Container&quot;</span> <span class="na">type=</span><span class="s">&quot;javax.sql.DataSource&quot;</span>
               <span class="na">maxTotal=</span><span class="s">&quot;100&quot;</span> <span class="na">maxIdle=</span><span class="s">&quot;30&quot;</span> <span class="na">maxWaitMillis=</span><span class="s">&quot;10000&quot;</span>
               <span class="na">username=</span><span class="s">&quot;你的数据库用户名&quot;</span> <span class="na">password=</span><span class="s">&quot;数据库密码&quot;</span> <span class="na">driverClassName=</span><span class="s">&quot;com.mysql.jdbc.Driver&quot;</span>
               <span class="na">url=</span><span class="s">&quot;jdbc:mysql://localhost:3306/你的数据库名字&quot;</span><span class="nt">/&gt;</span>
</code></pre></div>
<p>然后，找到WEB-INF/web.xml这个文件，同样双击之打开源码。进行注册，在<code>&lt;web-app&gt;</code>和<code>&lt;/web-app&gt;</code>标签之间加入以下代码：</p>
<div class="highlight"><pre><code class="language-xml" data-lang="xml">  <span class="nt">&lt;resource-ref&gt;</span>
      <span class="nt">&lt;description&gt;</span>DB Connection<span class="nt">&lt;/description&gt;</span>
      <span class="nt">&lt;res-ref-name&gt;</span>jdbc/工程名字<span class="nt">&lt;/res-ref-name&gt;</span>
      <span class="nt">&lt;res-type&gt;</span>javax.sql.DataSource<span class="nt">&lt;/res-type&gt;</span>
      <span class="nt">&lt;res-auth&gt;</span>Container<span class="nt">&lt;/res-auth&gt;</span>
  <span class="nt">&lt;/resource-ref&gt;</span>
</code></pre></div>
<p>最后，如果你建数据表的时候没有取得最高权限的话你需要在mysql的命令行模式下执行如下命令来取得权限：</p>
<div class="highlight"><pre><code class="language-sh" data-lang="sh">mysql&gt; GRANT ALL PRIVILEGES ON *.* TO 用户名@localhost
    -&gt;   IDENTIFIED BY <span class="s1">&#39;密码&#39;</span> WITH GRANT OPTION<span class="p">;</span>
</code></pre></div>
<p>至此，你完成了连接部分的配置。</p>

    <nav class="pagination-link">
        
        <a class="prev" href="http://laihaotao.github.io/2015/07/17/json.html" rel="bookmark">&laquo;&nbsp;使用第三方库json-lib来传递json格式数据</a>
        
        
        <a class="next" href="http://laihaotao.github.io/2015/07/19/jstl.html" rel="bookmark">使用jsp的JSTL标准标签配合数据库连接池与数据库进行交互&nbsp;&raquo;</a>
        
     </nav>
     <div id="disqus_thread"></div>
</article>  

        <center><footer id="foot">
            <p>Copyright © 2015 Eric_Lai All rights reserved.</p>
            <P>This theme template was designed by <a href="http://www.pizn.net" target="_blank" title="the One theme author">PIZn</a>, thanks!</P>
        </footer></center>
    </section>
</div>
<div id="foot-line"></div>
<script src="http://laihaotao.github.io/js/jquery.js" type="text/javascript"></script>
<script src="http://laihaotao.github.io/js/jquery.scrollTo.js" type="text/javascript"></script>
<script src="http://laihaotao.github.io/js/theOne.js" type="text/javascript"></script>
<script type="text/javascript">
$(document).ready(function() {
    /**
     * disqus
     */
    var disqusId = $("#disqus_thread");
    if(disqusId && typeof disqusId != "undefined" && disqusId.length != 0) {
        var disqusName = "Ericblog";
        var disqus_shortname = disqusName != "" ? disqusName : "piznblog";
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] ||
                document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    }
});
</script>
</body>
</html>
